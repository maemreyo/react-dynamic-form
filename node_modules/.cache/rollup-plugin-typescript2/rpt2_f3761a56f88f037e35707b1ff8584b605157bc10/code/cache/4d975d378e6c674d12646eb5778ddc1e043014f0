{"code":"// Filepath: /src/features/dynamic-form/hooks/useDynamicForm.ts\n// src/features/dynamic-form/hooks/useDynamicForm.ts\nimport { useEffect, useState } from 'react';\nimport { useForm } from 'react-hook-form';\nimport { debounce, saveToLocalStorage, flattenConfig, loadFromLocalStorage, } from '../utils';\n/**\n * Custom hook to manage form state and behavior.\n *\n * @param props - The hook props.\n * @returns The `react-hook-form` instance.\n */\nconst useDynamicForm = (props) => {\n    const { formOptions, autoSave, enableLocalStorage, resetOnSubmit, focusFirstError, debounceOnChange, onChange, onFormReady, config, } = props;\n    // Flatten the config to access default values and types easily\n    const flattenedConfig = flattenConfig(config);\n    // Create defaultValues object from flattened config\n    const defaultValues = Object.keys(flattenedConfig).reduce((acc, key) => {\n        if (flattenedConfig[key].defaultValue !== undefined) {\n            acc[key] = flattenedConfig[key].defaultValue;\n        }\n        return acc;\n    }, {});\n    const form = useForm({\n        ...formOptions,\n        defaultValues: defaultValues,\n    });\n    const { formState, reset, setFocus, watch, control } = form;\n    const { isSubmitSuccessful, errors } = formState;\n    // @ts-expect-error\n    const [isLocalStorageLoaded, setIsLocalStorageLoaded] = useState(false);\n    // Auto-save\n    useEffect(() => {\n        let intervalId = null;\n        if (autoSave) {\n            intervalId = setInterval(() => {\n                autoSave.save(watch());\n            }, autoSave.interval);\n        }\n        return () => {\n            if (intervalId)\n                clearInterval(intervalId);\n        };\n    }, [autoSave, watch]);\n    // LocalStorage - Save data\n    // @ts-expect-error\n    useEffect(() => {\n        if (enableLocalStorage) {\n            const subscription = watch((data) => saveToLocalStorage('form-data', data));\n            return () => subscription.unsubscribe();\n        }\n    }, [enableLocalStorage, watch]);\n    // LocalStorage - Load data\n    useEffect(() => {\n        if (enableLocalStorage) {\n            const loadedData = loadFromLocalStorage('form-data');\n            if (loadedData) {\n                const resetData = {};\n                for (const key in flattenedConfig) {\n                    const fieldConfig = flattenedConfig[key];\n                    if (loadedData[key] !== undefined) {\n                        if (fieldConfig.type === 'radio' ||\n                            fieldConfig.type === 'checkbox' ||\n                            fieldConfig.type === 'switch') {\n                            // Convert string to boolean for radio, checkbox, and switch types\n                            resetData[key] =\n                                loadedData[key] === 'true'\n                                    ? true\n                                    : loadedData[key] === 'false'\n                                        ? false\n                                        : loadedData[key];\n                            if (resetData[key] === undefined) {\n                                resetData[key] = fieldConfig.defaultValue;\n                            }\n                        }\n                        else if (fieldConfig.type === 'number') {\n                            // Convert string to number\n                            resetData[key] =\n                                loadedData[key] !== ''\n                                    ? parseFloat(loadedData[key])\n                                    : fieldConfig.defaultValue;\n                        }\n                        else {\n                            resetData[key] = loadedData[key];\n                        }\n                    }\n                }\n                reset(resetData);\n            }\n            setIsLocalStorageLoaded(true);\n        }\n    }, [enableLocalStorage, reset]);\n    // Reset on submit\n    useEffect(() => {\n        if (resetOnSubmit && isSubmitSuccessful) {\n            reset();\n        }\n    }, [resetOnSubmit, isSubmitSuccessful, reset]);\n    // Focus first error\n    useEffect(() => {\n        if (focusFirstError) {\n            const firstErrorKey = Object.keys(errors)[0];\n            if (firstErrorKey) {\n                setFocus(firstErrorKey);\n            }\n        }\n    }, [errors, focusFirstError, setFocus]);\n    // Debounce on change\n    // @ts-expect-error\n    useEffect(() => {\n        if (onChange) {\n            const debouncedOnChange = debounce(onChange, debounceOnChange || 0);\n            const subscription = watch((data) => debouncedOnChange(data));\n            return () => subscription.unsubscribe();\n        }\n    }, [watch, onChange, debounceOnChange]);\n    // onFormReady callback\n    useEffect(() => {\n        if (onFormReady) {\n            onFormReady(form);\n        }\n    }, [form, onFormReady]);\n    return {\n        ...form,\n        control,\n    };\n};\nexport default useDynamicForm;\n//# sourceMappingURL=useDynamicForm.js.map","references":["/Users/matthewngo/Documents/dev/projects/react-dynamic-form/node_modules/@types/react/index.d.ts","/Users/matthewngo/Documents/dev/projects/react-dynamic-form/node_modules/react-hook-form/dist/index.d.ts","/Users/matthewngo/Documents/dev/projects/react-dynamic-form/src/features/dynamic-form/utils/index.ts","/Users/matthewngo/Documents/dev/projects/react-dynamic-form/src/features/dynamic-form/types.ts"],"map":"{\"version\":3,\"file\":\"useDynamicForm.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../src/features/dynamic-form/hooks/useDynamicForm.ts\"],\"names\":[],\"mappings\":\"AAAA,+DAA+D;AAC/D,oDAAoD;AACpD,OAAO,EAAE,SAAS,EAAE,QAAQ,EAAE,MAAM,OAAO,CAAC;AAC5C,OAAO,EAAE,OAAO,EAA+B,MAAM,iBAAiB,CAAC;AACvE,OAAO,EACL,QAAQ,EACR,kBAAkB,EAClB,aAAa,EACb,oBAAoB,GACrB,MAAM,UAAU,CAAC;AAGlB;;;;;GAKG;AACH,MAAM,cAAc,GAAG,CAAC,KAAuB,EAA6B,EAAE;IAC5E,MAAM,EACJ,WAAW,EACX,QAAQ,EACR,kBAAkB,EAClB,aAAa,EACb,eAAe,EACf,gBAAgB,EAChB,QAAQ,EACR,WAAW,EACX,MAAM,GACP,GAAG,KAAK,CAAC;IAEV,+DAA+D;IAC/D,MAAM,eAAe,GAAG,aAAa,CAAC,MAAM,CAAC,CAAC;IAE9C,oDAAoD;IACpD,MAAM,aAAa,GAAG,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE;QACrE,IAAI,eAAe,CAAC,GAAG,CAAC,CAAC,YAAY,KAAK,SAAS,EAAE,CAAC;YACpD,GAAG,CAAC,GAAG,CAAC,GAAG,eAAe,CAAC,GAAG,CAAC,CAAC,YAAY,CAAC;QAC/C,CAAC;QACD,OAAO,GAAG,CAAC;IACb,CAAC,EAAE,EAAgB,CAAC,CAAC;IAErB,MAAM,IAAI,GAAG,OAAO,CAAa;QAC/B,GAAG,WAAW;QACd,aAAa,EAAE,aAAa;KACD,CAAC,CAAC;IAE/B,MAAM,EAAE,SAAS,EAAE,KAAK,EAAE,QAAQ,EAAE,KAAK,EAAE,OAAO,EAAE,GAAG,IAAI,CAAC;IAC5D,MAAM,EAAE,kBAAkB,EAAE,MAAM,EAAE,GAAG,SAAS,CAAC;IAEjD,mBAAmB;IACnB,MAAM,CAAC,oBAAoB,EAAE,uBAAuB,CAAC,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC;IAExE,YAAY;IACZ,SAAS,CAAC,GAAG,EAAE;QACb,IAAI,UAAU,GAA0B,IAAI,CAAC;QAC7C,IAAI,QAAQ,EAAE,CAAC;YACb,UAAU,GAAG,WAAW,CAAC,GAAG,EAAE;gBAC5B,QAAQ,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,CAAC;YACzB,CAAC,EAAE,QAAQ,CAAC,QAAQ,CAAC,CAAC;QACxB,CAAC;QACD,OAAO,GAAG,EAAE;YACV,IAAI,UAAU;gBAAE,aAAa,CAAC,UAAU,CAAC,CAAC;QAC5C,CAAC,CAAC;IACJ,CAAC,EAAE,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC,CAAC;IAEtB,2BAA2B;IAC3B,mBAAmB;IACnB,SAAS,CAAC,GAAG,EAAE;QACb,IAAI,kBAAkB,EAAE,CAAC;YACvB,MAAM,YAAY,GAAG,KAAK,CAAC,CAAC,IAAI,EAAE,EAAE,CAClC,kBAAkB,CAAC,WAAW,EAAE,IAAI,CAAC,CACtC,CAAC;YACF,OAAO,GAAG,EAAE,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC;QAC1C,CAAC;IACH,CAAC,EAAE,CAAC,kBAAkB,EAAE,KAAK,CAAC,CAAC,CAAC;IAEhC,2BAA2B;IAC3B,SAAS,CAAC,GAAG,EAAE;QACb,IAAI,kBAAkB,EAAE,CAAC;YACvB,MAAM,UAAU,GAAG,oBAAoB,CAAC,WAAW,CAAC,CAAC;YACrD,IAAI,UAAU,EAAE,CAAC;gBACf,MAAM,SAAS,GAAe,EAAE,CAAC;gBACjC,KAAK,MAAM,GAAG,IAAI,eAAe,EAAE,CAAC;oBAClC,MAAM,WAAW,GAAG,eAAe,CAAC,GAAG,CAAC,CAAC;oBACzC,IAAI,UAAU,CAAC,GAAG,CAAC,KAAK,SAAS,EAAE,CAAC;wBAClC,IACE,WAAW,CAAC,IAAI,KAAK,OAAO;4BAC5B,WAAW,CAAC,IAAI,KAAK,UAAU;4BAC/B,WAAW,CAAC,IAAI,KAAK,QAAQ,EAC7B,CAAC;4BACD,kEAAkE;4BAClE,SAAS,CAAC,GAAG,CAAC;gCACZ,UAAU,CAAC,GAAG,CAAC,KAAK,MAAM;oCACxB,CAAC,CAAC,IAAI;oCACN,CAAC,CAAC,UAAU,CAAC,GAAG,CAAC,KAAK,OAAO;wCAC3B,CAAC,CAAC,KAAK;wCACP,CAAC,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;4BAExB,IAAI,SAAS,CAAC,GAAG,CAAC,KAAK,SAAS,EAAE,CAAC;gCACjC,SAAS,CAAC,GAAG,CAAC,GAAG,WAAW,CAAC,YAAY,CAAC;4BAC5C,CAAC;wBACH,CAAC;6BAAM,IAAI,WAAW,CAAC,IAAI,KAAK,QAAQ,EAAE,CAAC;4BACzC,2BAA2B;4BAC3B,SAAS,CAAC,GAAG,CAAC;gCACZ,UAAU,CAAC,GAAG,CAAC,KAAK,EAAE;oCACpB,CAAC,CAAC,UAAU,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;oCAC7B,CAAC,CAAC,WAAW,CAAC,YAAY,CAAC;wBACjC,CAAC;6BAAM,CAAC;4BACN,SAAS,CAAC,GAAG,CAAC,GAAG,UAAU,CAAC,GAAG,CAAC,CAAC;wBACnC,CAAC;oBACH,CAAC;gBACH,CAAC;gBACD,KAAK,CAAC,SAAS,CAAC,CAAC;YACnB,CAAC;YACD,uBAAuB,CAAC,IAAI,CAAC,CAAC;QAChC,CAAC;IACH,CAAC,EAAE,CAAC,kBAAkB,EAAE,KAAK,CAAC,CAAC,CAAC;IAEhC,kBAAkB;IAClB,SAAS,CAAC,GAAG,EAAE;QACb,IAAI,aAAa,IAAI,kBAAkB,EAAE,CAAC;YACxC,KAAK,EAAE,CAAC;QACV,CAAC;IACH,CAAC,EAAE,CAAC,aAAa,EAAE,kBAAkB,EAAE,KAAK,CAAC,CAAC,CAAC;IAE/C,oBAAoB;IACpB,SAAS,CAAC,GAAG,EAAE;QACb,IAAI,eAAe,EAAE,CAAC;YACpB,MAAM,aAAa,GAAG,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;YAC7C,IAAI,aAAa,EAAE,CAAC;gBAClB,QAAQ,CAAC,aAAa,CAAC,CAAC;YAC1B,CAAC;QACH,CAAC;IACH,CAAC,EAAE,CAAC,MAAM,EAAE,eAAe,EAAE,QAAQ,CAAC,CAAC,CAAC;IAExC,qBAAqB;IACrB,mBAAmB;IACnB,SAAS,CAAC,GAAG,EAAE;QACb,IAAI,QAAQ,EAAE,CAAC;YACb,MAAM,iBAAiB,GAAG,QAAQ,CAAC,QAAQ,EAAE,gBAAgB,IAAI,CAAC,CAAC,CAAC;YACpE,MAAM,YAAY,GAAG,KAAK,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC,CAAC;YAC9D,OAAO,GAAG,EAAE,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC;QAC1C,CAAC;IACH,CAAC,EAAE,CAAC,KAAK,EAAE,QAAQ,EAAE,gBAAgB,CAAC,CAAC,CAAC;IAExC,uBAAuB;IACvB,SAAS,CAAC,GAAG,EAAE;QACb,IAAI,WAAW,EAAE,CAAC;YAChB,WAAW,CAAC,IAAI,CAAC,CAAC;QACpB,CAAC;IACH,CAAC,EAAE,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC,CAAC;IAExB,OAAO;QACL,GAAG,IAAI;QACP,OAAO;KACR,CAAC;AACJ,CAAC,CAAC;AAEF,eAAe,cAAc,CAAC\"}","dts":{"name":"/Users/matthewngo/Documents/dev/projects/react-dynamic-form/features/dynamic-form/hooks/useDynamicForm.d.ts","writeByteOrderMark":false,"text":"import { UseFormReturn } from 'react-hook-form';\nimport { DynamicFormProps, FormValues } from '../types';\n/**\n * Custom hook to manage form state and behavior.\n *\n * @param props - The hook props.\n * @returns The `react-hook-form` instance.\n */\ndeclare const useDynamicForm: (props: DynamicFormProps) => UseFormReturn<FormValues>;\nexport default useDynamicForm;\n"}}
