{"code":"import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { Input, Label, ErrorMessage, InputWrapper } from '../../../styles';\nimport styled from 'styled-components';\nimport { useFormContext, useController } from 'react-hook-form';\nconst ComboBoxContainer = styled.div `\n  position: relative;\n  width: 100%;\n`;\nconst DropdownList = styled.ul `\n  position: absolute;\n  top: 100%;\n  left: 0;\n  width: 100%;\n  border: 1px solid ${({ theme }) => theme.colors.border};\n  border-radius: 4px;\n  background-color: white;\n  z-index: 10;\n  list-style: none;\n  padding: 0;\n  margin: 4px 0 0 0;\n  max-height: 200px;\n  overflow-y: auto;\n`;\nconst DropdownItem = styled.li `\n  padding: 8px;\n  cursor: pointer;\n\n  &:hover {\n    background-color: ${({ theme }) => theme.colors.background};\n  }\n\n  &.selected {\n    background-color: ${({ theme }) => theme.colors.primary};\n    color: white;\n  }\n`;\nconst ComboBox = ({ id, fieldConfig, formClassNameConfig, showInlineError, horizontalLabel, labelWidth, error, }) => {\n    const { label, options } = fieldConfig;\n    const fieldClassNameConfig = fieldConfig.classNameConfig || {};\n    const formClassName = formClassNameConfig || {};\n    const [isOpen, setIsOpen] = useState(false);\n    const [inputValue, setInputValue] = useState('');\n    const [highlightedIndex, setHighlightedIndex] = useState(-1);\n    const containerRef = useRef(null);\n    const { control } = useFormContext();\n    const { field } = useController({\n        name: id,\n        control,\n        rules: fieldConfig.validation,\n    });\n    useEffect(() => {\n        setInputValue(field.value || '');\n    }, [field.value]);\n    const filteredOptions = options\n        ? options.filter((option) => option.label.toLowerCase().includes(inputValue.toLowerCase()))\n        : [];\n    const handleInputChange = (event) => {\n        const val = event.target.value;\n        setInputValue(val);\n        field.onChange(event); // Update form state\n        if (!isOpen && val) {\n            setIsOpen(true);\n        }\n        else if (isOpen && !val) {\n            setIsOpen(false);\n        }\n    };\n    const handleOptionClick = (value) => {\n        setInputValue(value);\n        field.onChange(value); // Update form state\n        setIsOpen(false);\n    };\n    const toggleDropdown = () => {\n        setIsOpen(!isOpen);\n    };\n    const closeDropdown = useCallback(() => {\n        setIsOpen(false);\n    }, []);\n    useEffect(() => {\n        const handleClickOutside = (event) => {\n            if (containerRef.current &&\n                !containerRef.current.contains(event.target)) {\n                closeDropdown();\n            }\n        };\n        document.addEventListener('mousedown', handleClickOutside);\n        return () => document.removeEventListener('mousedown', handleClickOutside);\n    }, [closeDropdown]);\n    const handleKeyDown = (event) => {\n        if (event.key === 'ArrowDown') {\n            event.preventDefault();\n            setHighlightedIndex((prevIndex) => filteredOptions.length > 0\n                ? Math.min(prevIndex + 1, filteredOptions.length - 1)\n                : -1);\n        }\n        else if (event.key === 'ArrowUp') {\n            event.preventDefault();\n            setHighlightedIndex((prevIndex) => prevIndex > 0 ? prevIndex - 1 : filteredOptions.length - 1);\n        }\n        else if (event.key === 'Enter') {\n            event.preventDefault();\n            if (highlightedIndex >= 0) {\n                const selectedValue = filteredOptions[highlightedIndex].value;\n                setInputValue(selectedValue);\n                field.onChange(selectedValue); // Update form state\n                setIsOpen(false);\n            }\n        }\n        else if (event.key === 'Escape') {\n            event.preventDefault();\n            setIsOpen(false);\n        }\n    };\n    useEffect(() => {\n        if (isOpen && highlightedIndex >= 0 && containerRef.current) {\n            const item = containerRef.current.querySelector(`li:nth-child(${highlightedIndex + 1})`);\n            if (item) {\n                item.scrollIntoView({ block: 'nearest', inline: 'start' });\n            }\n        }\n    }, [isOpen, highlightedIndex]);\n    return (React.createElement(InputWrapper, { \"$horizontalLabel\": horizontalLabel, \"$labelWidth\": labelWidth, className: fieldClassNameConfig.inputWrapper || formClassName.inputWrapper },\n        label && (React.createElement(Label, { htmlFor: id, \"$horizontalLabel\": horizontalLabel, \"$labelWidth\": labelWidth, className: fieldClassNameConfig.label || formClassName.label },\n            label,\n            fieldConfig.validation?.required && (React.createElement(\"span\", { style: { color: 'red' } }, \"*\")))),\n        React.createElement(ComboBoxContainer, { ref: containerRef },\n            React.createElement(Input, { ...field, className: fieldClassNameConfig.input || formClassName.input, id: id, value: inputValue, onChange: handleInputChange, onClick: toggleDropdown, onKeyDown: handleKeyDown, autoComplete: \"off\" }),\n            isOpen && (React.createElement(DropdownList, null, filteredOptions.length > 0 ? (filteredOptions.map((option, index) => (React.createElement(DropdownItem, { key: option.value, onClick: () => handleOptionClick(option.value), className: index === highlightedIndex ? 'selected' : '' }, option.label)))) : (React.createElement(DropdownItem, null, \"No results found\"))))),\n        showInlineError && error && (React.createElement(ErrorMessage, { className: fieldClassNameConfig.errorMessage || formClassName.errorMessage }, error.message))));\n};\nexport default ComboBox;\n//# sourceMappingURL=ComboBox.js.map","references":["/Users/matthewngo/Documents/dev/projects/react-dynamic-form/node_modules/@types/react/index.d.ts","/Users/matthewngo/Documents/dev/projects/react-dynamic-form/src/styles.ts","/Users/matthewngo/Documents/dev/projects/react-dynamic-form/src/features/dynamic-form/index.ts","/Users/matthewngo/Documents/dev/projects/react-dynamic-form/node_modules/styled-components/dist/index.d.ts","/Users/matthewngo/Documents/dev/projects/react-dynamic-form/node_modules/react-hook-form/dist/index.d.ts"],"map":"{\"version\":3,\"file\":\"ComboBox.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../src/features/inputs/components/ComboBox.tsx\"],\"names\":[],\"mappings\":\"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\"}"}
